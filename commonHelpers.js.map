{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst gallery = document.getElementById('gallery');\nconst form = document.getElementById('form');\nconst input = document.getElementById('input');\nconst btnLoadMore = document.querySelector('.btn-load-more');\nconst loader = document.querySelector('.loader');\n\nlet prevSearchTerm = '';\nconst paramsInfo = {\n  key: \"41508094-b690cca5e0d97ff8185874dce\",\n  q: \" \",\n  image_type: \"photo\",\n  orientation: \"horizontal\",\n  safesearch: \"true\",\n  page: 1,\n  per_page: 40\n};\n\nlet page = paramsInfo.page;\nlet per_page = paramsInfo.per_page;\nlet totalHits;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  nav: true,\n  captionDelay: 250,\n  captionData: 'alt',\n  close: true,\n  enableKeyboard: true,\n  docClose: true,\n});\n\nform.addEventListener('submit', event => {\n  event.preventDefault();\n  const searchTerm = input.value.trim();\n  if (searchTerm) {\n  paramsInfo.q = searchTerm;\n  paramsInfo.page = 1;\n  paramsInfo.per_page = per_page;\n\n  gallery.innerHTML = '';\n  uniqueImages.length = 0;\n  prevSearchTerm = searchTerm;\n\n  searchImg();\n  showLoader()\n  showLoadMore()\n} else {\n  iziToast.info({\n    position: 'bottomCenter',\n    message: \"Please enter a search term.\",\n  });\n}\n});\n\n\nbtnLoadMore.addEventListener('click', event => {\n  event.preventDefault();\n  const searchTerm = input.value.trim();\n\n  if (prevSearchTerm) {\n    showLoader();\n    paramsInfo.q = prevSearchTerm; \n    paramsInfo.page += 1;\n    paramsInfo.per_page = per_page; \n    searchImg();\n  } else {\n    iziToast.info({\n      position: 'bottomCenter',\n      message: \"Please enter a search term.\",\n    });\n  }\n});\n\n\nasync function fetchImagesData(url) {\n  try {\n    const response = await axios.get(url);\n    const { data } = response;\n    if (data.total === 0) {\n      throw new Error(\"Sorry, there are no images matching your search query. Please try again!\");\n    }\n    return data;\n  } catch (error) {\n    throw new Error(\"Failed to fetch images data. Please try again!\");\n  }\n}\n\nconst uniqueImages = [];\n\nasync function searchImg() {\n  const url = new URL(\"https://pixabay.com/api/\");\n  const searchParams = new URLSearchParams(paramsInfo);\n   url.search = searchParams.toString();\n\n  try {\n    const { hits, totalHits: hitsCount } = await fetchImagesData(url, paramsInfo);\n    totalHits = hitsCount;  \n    \n    if (hits.length === 0) {\n      hideLoader();\n      hideLoadMore()\n      iziToast.info({\n        position: 'bottomCenter',\n        message: \"We're sorry, but there are no results matching your search criteria.\",\n      });\n    } else {\n      const uniqueHits = hits.filter(hit => !uniqueImages.includes(hit.webformatURL));\n      uniqueImages.push(...uniqueHits.map(hit => hit.webformatURL));            \n      const renderImg = uniqueHits.reduce((html, hit) => {\n      return (\n        html +\n            `<li class=\"gallery-item\">\n                <a href=${hit.largeImageURL}>\n                <img src=${hit.webformatURL} class=\"foto\" alt=${hit.tags}/>\n                </a>\n                <div class=\"benefits\">\n                <div class=\"benefit-text\">\n                <span class=\"text-value\">Likes</span><p class=\"number\">${hit.likes}</p></div>\n                <div class=\"benefit-text\">\n                <span class=\"text-value\">Views</span><p class=\"number\">${hit.views}</p></div>\n                <div class=\"benefit-text\">\n                <span class=\"text-value\">Comments</span><p class=\"number\">${hit.comments}</p></div>\n                <div class=\"benefit-text\">\n                <span class=\"text-value\">Downloads</span><p class=\"number\">${hit.downloads}</p></div>\n                </div>\n            </li>`\n            );\n        }, \"\");\n        \n    gallery.innerHTML += renderImg;\n  \n  lightbox.refresh();\n  \nconst galleryItem = gallery.querySelector('.gallery-item');\nif (galleryItem) {\n  const cardHeight = galleryItem.getBoundingClientRect().height;\n\nif (hits.length < per_page || page * per_page >= totalHits) {\n  hideLoader();\n  hideLoadMore();\n\nif (totalHits === gallery.querySelectorAll('.gallery-item').length) {\n    \n    hideLoadMore();\n  }\n  iziToast.info({\n    position: 'bottomCenter',\n    message: \"We're sorry, but you've reached the end of search results.\",\n  });\n  \n} else {\n  hideLoader();\n  showLoadMore();\n  const scrollDistance = 2 * cardHeight;\n  window.scrollBy({\n    top: scrollDistance,\n    behavior: 'smooth',\n   });\n  }\n }\n}\n} catch (error) {\nhideLoader();\niziToast.error({\nposition: 'bottomCenter',\nmessage: error.message,\n});\n}\n}\n\nfunction showLoader() {\nconst loader = document.querySelector('.loader');\nif (loader) {\n  loader.style.display = 'block';\n}\n}\n\nfunction hideLoader() {\nconst loader = document.querySelector('.loader');\nif (loader) {\n  loader.style.display = 'none';\n}\n}\n\nfunction showLoadMore() {\nconst loadMore = document.querySelector('.btn-load-more');\nif (loadMore) {\n  loadMore.style.display = 'block';\n}\n}\n\nfunction hideLoadMore() {\nconst loadMore = document.querySelector('.btn-load-more');\nif (loadMore) {\n  loadMore.style.display = 'none';\n}\n}\n\n"],"names":["gallery","form","input","btnLoadMore","prevSearchTerm","paramsInfo","page","per_page","totalHits","lightbox","SimpleLightbox","event","searchTerm","uniqueImages","searchImg","showLoader","showLoadMore","iziToast","fetchImagesData","url","response","axios","data","searchParams","hits","hitsCount","hideLoader","hideLoadMore","uniqueHits","hit","renderImg","html","galleryItem","cardHeight","scrollDistance","error","loader","loadMore"],"mappings":"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"}