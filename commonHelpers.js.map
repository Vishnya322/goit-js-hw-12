{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst gallery = document.getElementById('gallery');\nconst form = document.getElementById('form');\nconst input = document.getElementById('input');\nconst btnLoadMore = document.querySelector('.btn-load-more');\nconst loader = document.querySelector('.loader');\n\n\nconst paramsInfo = {\n  key: \"41508094-b690cca5e0d97ff8185874dce\",\n  q: \"kat\",\n  image_type: \"photo\",\n  orientation: \"horizontal\",\n  safesearch: \"true\",\n  page: 1,\n  per_page: 40\n};\n\nlet page = paramsInfo.page;\nlet per_page = paramsInfo.per_page;\nlet totalHits;\n\nform.addEventListener('submit', event => {\n  event.preventDefault();\n  const searchTerm = input.value.trim();\n  if (searchTerm) {\n  paramsInfo.q = searchTerm;\n  paramsInfo.page = 1;\n  paramsInfo.per_page = per_page;\n  \n  searchImg();\n  showLoader()\n  showLoadMore()\n} else {\n  iziToast.info({\n    position: 'bottomCenter',\n    message: \"Please enter a search term.\",\n  });\n}\n});\n\nbtnLoadMore.addEventListener('click', event => {\n  event.preventDefault();\n  showLoader();\n  const searchTerm = input.value.trim();\n\n  if (searchTerm) {\n  paramsInfo.q = searchTerm;\n  paramsInfo.page += 1;\n  paramsInfo.per_page = per_page; \n  searchImg();\n} else {\n  iziToast.info({\n    position: 'bottomCenter',\n    message: \"Please enter a search term.\",\n  });\n}\n});\n\nasync function fetchViews(url) {\n  const response = await fetch(url);\n\n  if (!response.ok) {\n    throw new Error(\"Sorry, there are no images matching your search query. Please try again!\");\n  }\n  return response.json();\n}\n\nasync function searchImg() {\n  const url = new URL(\"https://pixabay.com/api/\");\n  const searchParams = new URLSearchParams(paramsInfo);\n   url.search = searchParams.toString();\n\n  try {\n    paramsInfo.page = page;\n    const { hits, totalHits: hitsCount } = await fetchViews(url, paramsInfo);\n    totalHits = hitsCount;  \n    \n    if (hits.length === 0) {\n      hideLoader();\n      hideLoadMore()\n      iziToast.info({\n        position: 'bottomCenter',\n        message: \"We're sorry, but there are no results matching your search criteria.\",\n      });\n    } else {\n    const renderImg = hits.reduce((html, hit) => {\n      return (\n        html +\n            `<li class=\"gallery-item\">\n                <a href=${hit.largeImageURL}>\n                <img src=${hit.webformatURL} class=\"foto\" alt=${hit.tags}/>\n                </a>\n                <div class=\"benefits\">\n                <div class=\"benefit-text\">\n                <span class=\"text-value\">Likes</span><p class=\"number\">${hit.likes}</p></div>\n                <div class=\"benefit-text\">\n                <span class=\"text-value\">Views</span><p class=\"number\">${hit.views}</p></div>\n                <div class=\"benefit-text\">\n                <span class=\"text-value\">Comments</span><p class=\"number\">${hit.comments}</p></div>\n                <div class=\"benefit-text\">\n                <span class=\"text-value\">Downloads</span><p class=\"number\">${hit.downloads}</p></div>\n                </div>\n            </li>`\n            );\n        }, \"\");\n    gallery.innerHTML += renderImg;\n\n    const lightbox = new SimpleLightbox('.gallery a', {\n      nav: true,\n      captionDelay: 250,\n      captionData: 'alt',\n      close: true,\n      enableKeyboard: true,\n      docClose: true,\n  });\n\n  lightbox.refresh();\n  \n  if (gallery.querySelector('.gallery-item')) {\n    const cardHeight = gallery.querySelector('.gallery-item').getBoundingClientRect().height;\n\n    if (hits.length < per_page || page * per_page >= totalHits) {\n      hideLoader();\n      hideLoadMore();\n      iziToast.info({\n        position: 'bottomCenter',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      hideLoader();\n      showLoadMore();\n      const scrollDistance = 2 * cardHeight;\n      window.scrollBy({\n        top: scrollDistance,\n        behavior: 'smooth',\n      });\n    }\n  }\n }\n} catch (error) {\n  hideLoader();\n  iziToast.error({\n    position: 'bottomCenter',\n    message: error.message,\n  });\n }\n  }\n\nfunction showLoader() {\nconst loader = document.querySelector('.loader');\nif (loader) {\n  loader.style.display = 'block';\n}\n}\n\nfunction hideLoader() {\nconst loader = document.querySelector('.loader');\nif (loader) {\n  loader.style.display = 'none';\n}\n}\n\nfunction showLoadMore() {\nconst loadMore = document.querySelector('.btn-load-more');\nif (loadMore) {\n  loadMore.style.display = 'block';\n}\n}\n\nfunction hideLoadMore() {\nconst loadMore = document.querySelector('.btn-load-more');\nif (loadMore) {\n  loadMore.style.display = 'none';\n}\n}\n\n"],"names":["gallery","form","input","btnLoadMore","paramsInfo","page","per_page","totalHits","event","searchTerm","searchImg","showLoader","showLoadMore","iziToast","fetchViews","url","response","searchParams","hits","hitsCount","hideLoader","hideLoadMore","renderImg","html","hit","SimpleLightbox","cardHeight","scrollDistance","error","loader","loadMore"],"mappings":"6vBAMA,MAAMA,EAAU,SAAS,eAAe,SAAS,EAC3CC,EAAO,SAAS,eAAe,MAAM,EACrCC,EAAQ,SAAS,eAAe,OAAO,EACvCC,EAAc,SAAS,cAAc,gBAAgB,EAC5C,SAAS,cAAc,SAAS,EAG/C,MAAMC,EAAa,CACjB,IAAK,qCACL,EAAG,MACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,KAAM,EACN,SAAU,EACZ,EAEA,IAAIC,EAAOD,EAAW,KAClBE,EAAWF,EAAW,SACtBG,EAEJN,EAAK,iBAAiB,SAAUO,GAAS,CACvCA,EAAM,eAAc,EACpB,MAAMC,EAAaP,EAAM,MAAM,KAAI,EAC/BO,GACJL,EAAW,EAAIK,EACfL,EAAW,KAAO,EAClBA,EAAW,SAAWE,EAEtBI,IACAC,EAAY,EACZC,EAAc,GAEdC,EAAS,KAAK,CACZ,SAAU,eACV,QAAS,6BACb,CAAG,CAEH,CAAC,EAEDV,EAAY,iBAAiB,QAASK,GAAS,CAC7CA,EAAM,eAAc,EACpBG,IACA,MAAMF,EAAaP,EAAM,MAAM,KAAI,EAE/BO,GACJL,EAAW,EAAIK,EACfL,EAAW,MAAQ,EACnBA,EAAW,SAAWE,EACtBI,KAEAG,EAAS,KAAK,CACZ,SAAU,eACV,QAAS,6BACb,CAAG,CAEH,CAAC,EAED,eAAeC,EAAWC,EAAK,CAC7B,MAAMC,EAAW,MAAM,MAAMD,CAAG,EAEhC,GAAI,CAACC,EAAS,GACZ,MAAM,IAAI,MAAM,0EAA0E,EAE5F,OAAOA,EAAS,MAClB,CAEA,eAAeN,GAAY,CACzB,MAAMK,EAAM,IAAI,IAAI,0BAA0B,EACxCE,EAAe,IAAI,gBAAgBb,CAAU,EAClDW,EAAI,OAASE,EAAa,WAE3B,GAAI,CACFb,EAAW,KAAOC,EAClB,KAAM,CAAE,KAAAa,EAAM,UAAWC,CAAS,EAAK,MAAML,EAAWC,EAAKX,CAAU,EAGvE,GAFAG,EAAYY,EAERD,EAAK,SAAW,EAClBE,IACAC,EAAc,EACdR,EAAS,KAAK,CACZ,SAAU,eACV,QAAS,sEACjB,CAAO,MACI,CACP,MAAMS,EAAYJ,EAAK,OAAO,CAACK,EAAMC,IAEjCD,EACI;AAAA,0BACcC,EAAI;AAAA,2BACHA,EAAI,iCAAiCA,EAAI;AAAA;AAAA;AAAA;AAAA,yEAIKA,EAAI;AAAA;AAAA,yEAEJA,EAAI;AAAA;AAAA,4EAEDA,EAAI;AAAA;AAAA,6EAEHA,EAAI;AAAA;AAAA,mBAItE,EAAE,EAcX,GAbExB,EAAQ,WAAasB,EAEJ,IAAIG,EAAe,aAAc,CAChD,IAAK,GACL,aAAc,IACd,YAAa,MACb,MAAO,GACP,eAAgB,GAChB,SAAU,EAChB,CAAG,EAEQ,QAAO,EAEZzB,EAAQ,cAAc,eAAe,EAAG,CAC1C,MAAM0B,EAAa1B,EAAQ,cAAc,eAAe,EAAE,sBAAuB,EAAC,OAElF,GAAIkB,EAAK,OAASZ,GAAYD,EAAOC,GAAYC,EAC/Ca,IACAC,IACAR,EAAS,KAAK,CACZ,SAAU,eACV,QAAS,4DACjB,CAAO,MACI,CACLO,IACAR,IACA,MAAMe,EAAiB,EAAID,EAC3B,OAAO,SAAS,CACd,IAAKC,EACL,SAAU,QAClB,CAAO,CACF,CACF,CACD,CACF,OAASC,EAAP,CACAR,IACAP,EAAS,MAAM,CACb,SAAU,eACV,QAASe,EAAM,OACnB,CAAG,CACD,CACC,CAEH,SAASjB,GAAa,CACtB,MAAMkB,EAAS,SAAS,cAAc,SAAS,EAC3CA,IACFA,EAAO,MAAM,QAAU,QAEzB,CAEA,SAAST,GAAa,CACtB,MAAMS,EAAS,SAAS,cAAc,SAAS,EAC3CA,IACFA,EAAO,MAAM,QAAU,OAEzB,CAEA,SAASjB,GAAe,CACxB,MAAMkB,EAAW,SAAS,cAAc,gBAAgB,EACpDA,IACFA,EAAS,MAAM,QAAU,QAE3B,CAEA,SAAST,GAAe,CACxB,MAAMS,EAAW,SAAS,cAAc,gBAAgB,EACpDA,IACFA,EAAS,MAAM,QAAU,OAE3B"}